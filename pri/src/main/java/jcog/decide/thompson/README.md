from: https://github.com/wealthfront/thompson-sampling